#!/usr/bin/python3.6
import json
import unicodedata
import datetime
import jsonlines
import sys
import os
import glob
from backports import csv
import urllib.request
import time

with open('watchlist.csv', 'w') as csv_file:
	writer = csv.writer(csv_file)
	with urllib.request.urlopen("https://cve.circl.lu/api/browse/") as url:
		vendor = json.loads(url.read().decode())
		for vendors in vendor["vendor"]:
			time.sleep(0.2)
			print(vendors)
			try:
				with urllib.request.urlopen("https://cve.circl.lu/api/browse/%s" % vendors) as producturl:
					product = json.loads(producturl.read().decode())
					for products in product["product"]:
						
						writer.writerow([vendors,products])
			except:
				print("Not found")